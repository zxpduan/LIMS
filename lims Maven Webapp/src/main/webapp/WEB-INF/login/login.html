<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta charset="utf-8" />
<title>正辉小贷CIMS</title>
<meta name="description" content="User login page" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
<link rel="shortcut icon" href="/lims/favricon.ico" />
<!-- bootstrap & fontawesome -->
<link rel="stylesheet" href="/lims/assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="/lims/assets/css/font-awesome.min.css" />
<!-- text fonts -->
<link rel="stylesheet" href="/lims/assets/css/ace-fonts.css" />
<!-- ace styles -->
<link rel="stylesheet" href="/lims/assets/css/ace.css" />
<!--[if lte IE 9]>
			<link rel="stylesheet" href="/lims/assets/css/ace-part2.min.css" />
		<![endif]-->
<link rel="stylesheet" href="/lims/assets/css/ace-rtl.min.css" />
<!--[if lte IE 9]>
		  <link rel="stylesheet" href="/lims/assets/css/ace-ie.min.css" />
		<![endif]-->
<link rel="stylesheet" href="/lims/assets/css/ace.onpage-help.css" />
<link rel="stylesheet" href="/lims/assets/css/mine.css" />
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
		<script src="/lims/assets/js/html5shiv.js"></script>
		<script src="/lims/assets/js/respond.min.js"></script>
		<![endif]-->
</head>
<body class="login-layout light-login">
	<div id="_cont" style="display:table; width:100%;  height:800px;">
		<div class="row" style="display: table-cell; vertical-align: middle;">
			<div class="col-sm-10 col-sm-offset-1">
				<div class="center">
					<h1>
						<img id="l_logo" src="/lims/images/logo.png" style="vertical-align:middle;" /> <span class="white_login" id="id-text2" style="vertical-align:middle;">信贷信息管理系统</span>
					</h1>
					<h4 class="blue" id="id-company-text">&copy; 正辉小额贷款有限公司</h4>
				</div>
				<div class="login-container">
					<div class="space-6"></div>
					<div class="position-relative">
						<div id="login-box" class="login-box visible widget-box no-border">
							<div class="widget-body">
								<div class="widget-main">
									<h4 class="header blue lighter bigger">
										<i class="ace-icon fa fa-coffee green"></i> 请输入登录信息
									</h4>
									<div class="space-6"></div>
									<form id="login_form" action="/lims/index.action">
										<fieldset>
											<label class="block clearfix"> <span class="block input-icon input-icon-right"> 
											<input type="text" id="j_username" name="username"
													class="form-control" placeholder="用户名" /> <i class="ace-icon fa fa-user"></i>
											</span>
											</label> <label class="block clearfix"> <span class="block input-icon input-icon-right"> <input type="password" class="form-control"
													name="password" placeholder="密码" id="j_password" /> <i class="ace-icon fa fa-lock"></i>
											</span>
											</label> <label class="block clearfix"> <span class="block input-icon input-icon-right"> <input type="text" class="form-control"
													name="verifycode" placeholder="验证码" id="verifycode" /> <img id="imgObj" class="ace-icon" alt="点击更换" title="点击更换" style="width:120px;"
													src="verifyCodeAction.action" style="vertical-align:middle;" />
											</span>
											</label>
											<div class="space"></div>
											<div class="clearfix">
												<label class="inline"> <input type="checkbox" name="remembered" id="j_remember" class="ace" /> <span class="lbl"> 记住账号</span>
												</label>
												<button type="button" id="login_btn" class="width-35 pull-right btn btn-sm btn-primary">
													<i class="ace-icon fa fa-key"></i> <span class="bigger-110">登录</span>
												</button>
											</div>
											<div class="space-4"></div>
										</fieldset>
									</form>
									<div class="space-6"></div>
								</div>
								<!-- /.widget-main -->
								<div class="toolbar clearfix">
									<div>
										<a href="#" data-target="#forgot-box" class="forgot-password-link"> <i class="ace-icon fa fa-arrow-left"></i> 忘记密码
										</a>
									</div>
								</div>
							</div>
							<!-- /.widget-body -->
						</div>
						<!-- /.login-box -->
						<div id="forgot-box" class="forgot-box widget-box no-border">
							<div class="widget-body">
								<div class="widget-main">
									<h4 class="header red lighter bigger">
										<i class="ace-icon fa fa-key"></i> 联系管理员
									</h4>
									<div class="space-6"></div>
									<p>管理员为：Admin </p><p>电话：15981818149 或18538237767。</p>
								</div>
								<!-- /.widget-main -->
								<div class="toolbar center">
									<a href="#" data-target="#login-box" class="back-to-login-link"> 返回到登录界面 <i class="ace-icon fa fa-arrow-right"></i>
									</a>
								</div>
							</div>
							<!-- /.widget-body -->
						</div>
						<!-- /.forgot-box -->
						<div id="signup-box" class="signup-box widget-box no-border">
							<div class="widget-body">
								<div class="widget-main">
									<h4 class="header green lighter bigger">
										<i class="ace-icon fa fa-users blue"></i> New User Registration
									</h4>
									<div class="space-6"></div>
									<p>Enter your details to begin:</p>
									<form>
										<fieldset>
											<label class="block clearfix"> <span class="block input-icon input-icon-right"> <input type="email" class="form-control"
													placeholder="Email" /> <i class="ace-icon fa fa-envelope"></i>
											</span>
											</label> <label class="block clearfix"> <span class="block input-icon input-icon-right"> <input type="text" class="form-control"
													placeholder="Username" /> <i class="ace-icon fa fa-user"></i>
											</span>
											</label> <label class="block clearfix"> <span class="block input-icon input-icon-right"> <input type="password" class="form-control"
													placeholder="Password" /> <i class="ace-icon fa fa-lock"></i>
											</span>
											</label> <label class="block clearfix"> <span class="block input-icon input-icon-right"> <input type="password" class="form-control"
													placeholder="Repeat password" /> <i class="ace-icon fa fa-retweet"></i>
											</span>
											</label> <label class="block"> <input type="checkbox" class="ace" /> <span class="lbl"> I accept the <a href="#">User Agreement</a>
											</span>
											</label>
											<div class="space-24"></div>
											<div class="clearfix">
												<button type="reset" class="width-30 pull-left btn btn-sm">
													<i class="ace-icon fa fa-refresh"></i> <span class="bigger-110">Reset</span>
												</button>
												<button type="button" class="width-65 pull-right btn btn-sm btn-success">
													<span class="bigger-110">Register</span> <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
												</button>
											</div>
										</fieldset>
									</form>
								</div>
								<div class="toolbar center">
									<a href="#" data-target="#login-box" class="back-to-login-link"> <i class="ace-icon fa fa-arrow-left"></i> Back to login
									</a>
								</div>
							</div>
							<!-- /.widget-body -->
						</div>
						<!-- /.signup-box -->
					</div>
					<!-- /.position-relative -->
					<div class="navbar-fixed-top align-right">
						&nbsp; <a id="btn-login-dark" href="#">沉稳黑色</a> &nbsp; <span class="blue">/</span> &nbsp; <a id="btn-login-blur" href="#">蓝色魅影</a> &nbsp; <span
							class="blue">/</span> &nbsp; <a id="btn-login-light" href="#">明亮背景</a> &nbsp; &nbsp; &nbsp;
					</div>
				</div>
			</div>
			<!-- /.col -->
		</div>
		<!-- /.row -->
	</div>
	<!-- /.main-content -->
	<!-- basic scripts -->
	<!--[if !IE]> -->
	<script type="text/javascript">
			window.jQuery || document.write("<script src='assets/js/uncompressed/jquery.js'>"+"<"+"/script>");
		</script>
	<!-- <![endif]-->
	<!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='/lims/assets/js/jquery1x.min.js'>"+"<"+"/script>");
</script>
<![endif]-->
	<script type="text/javascript">
		if ('ontouchstart' in document.documentElement)
			document.write("<script src='/lims/assets/js/jquery.mobile.custom.min.js'>" + "<"+"/script>");
	</script>
	<script type="text/javascript">
		document.write("<script src='/lims/assets/js/jquery.validate.min.js'>" + "<"+"/script>");
		document.write("<script src='/lims/assets/js/jquery.metadata.js'>" + "<"+"/script>");
		document.write("<script src='/lims/assets/js/message_zh.js'>" + "<"+"/script>");
	</script>
	<script src="/lims/assets/js/uncompressed/jquery.cookie.js" type="text/javascript"></script>
	<script src="assets/js/mine.js"></script>
	<!-- inline scripts related to this page -->
	<script type="text/javascript">
		var bgstyle = 0;
		var COOKIE_NAME = 'sys__username';
		$(function() {
	    
			if ($.cookie(COOKIE_NAME)){
			    $("#j_username").val($.cookie(COOKIE_NAME));
			    $("#j_password").focus();
			    $("#j_remember").attr('checked', true);
			} else {
				$("#j_username").focus();
			}
		});
		//////////////////////////
		var validator = null;//for add customer form validate
		/*
			validate form
		 */
		function validateCheck(form_id_str) {
		return validator = $("#" + form_id_str).validate({
			debug : true, //调试模式取消submit的默认提交功能   
			//errorClass: "label.error", //默认为错误的样式类为：error   
			focusInvalid : true, //当为false时，验证无效时，没有焦点响应  
			onkeyup : false,
			submitHandler : function(form) { //表单提交句柄,为一回调函数，带一个参数：form   
				alert("提交表单");
			},
			rules : {
			username : {
				required : true
			},
			verifycode : {
				required : true
			},
			password : {
			required : true
			//,minlength : 6
			}

			},			
			messages : {
					username : {
						required : '<font color=red>请输入账号</font>'
					},
					verifycode : {
						required : '<font color=red>请输入验证码</font>'
					},
					password : {
					required : '<font color=red>请输入密码</font>',
					minlength : '<font color=red>请至少输入6个字符</font>'
					}
			},
			highlight : function(element) {								
				$(element).css("border", "1px solid rgb(213, 9, 0)");
			},
			unhighlight : function(element) {
				$(element).css("border", "1px solid rgb(213, 213, 213)");
			}
			});	
		}
		
		///////////////////////////
		function location_loginform() {
			$("#_cont").css("height", $(window).height() * 0.85);
		}
		$("#login_btn").on("click",function(){
				var $remember = $("#j_remember");
				if ($remember.prop('checked')) {
					$.cookie(COOKIE_NAME, $("#j_username").val(), { path: '/', expires: 15 });					
				} else {					
					$.cookie(COOKIE_NAME, null, { path: '/' });  //删除cookie
				}
				var $form=$("#login_form");
				validator=validateCheck("login_form");				
				var params=$form.zxp_serialize();
				if (validator.form()){
							$.ajax({
						//global:false,
						url : 'loginAction.action',
						type : 'POST',
						dataType : "json",
						//url:$form.attr("action"),
						data : $("#login_form").serializeArray(),
						cache : false,
						timeout : 3000,
						error : function(XMLHttpRequest, textStatus, errorThrown) {
							//alert(XMLHttpRequest.responseText);
							//alert(XMLHttpRequest.readyState);
							//alert(textStatus);
							alert("网络错误，请刷新页面。如果没有解决您的问题，请联系管理员。");			
						},
						success : function(data) {
							//alert(data.username+":"+data.pw);
			
							//alert(data);
							if (data.isok == 1) {
								location.href = "index_index.action?fcode=001";
							} else if (data.isok == 3) {
								alert("用户不存在或密码不正确！");
							} else if (data.isok == 4) {
								alert("验证码错误！");
							}
						}
						});
				}
		});
		
		
			
		jQuery(function($) {

			$('#id-text2').attr('class', 'black');
			location_loginform();
			$(document).on('click', '.toolbar a[data-target]', function(e) {
				e.preventDefault();
				var target = $(this).data('target');
				$('.widget-box.visible').removeClass('visible');//hide others
				$(target).addClass('visible');//show target
				if (bgstyle == 0)
					$('#l_logo').attr("src", "/lims/images/logo.png");
				else
					$('#l_logo').attr("src", "/lims/images/logo_w.png");
			});
		});

		//you don't need this, just used for changing background
		jQuery(function($) {
			$(window).resize(function() {
				location_loginform();
			});
			$('#btn-login-dark').on('click', function(e) {
				$('body').attr('class', 'login-layout');
				$('#id-text2').attr('class', 'white_login');
				$('#id-company-text').attr('class', 'blue');
				$('#l_logo').attr("src", "/lims/images/logo_w.png");
				bgstyle = 1;
				e.preventDefault();
			});
			$('#btn-login-light').on('click', function(e) {
				$('body').attr('class', 'login-layout light-login');
				$('#id-text2').attr('class', 'black');
				$('#id-company-text').attr('class', 'blue');
				$('#l_logo').attr("src", "/lims/images/logo.png");
				bgstyle = 0;
				e.preventDefault();
			});
			$('#btn-login-blur').on('click', function(e) {
				$('body').attr('class', 'login-layout blur-login');
				$('#id-text2').attr('class', 'white_login');
				$('#id-company-text').attr('class', 'light-blue');
				$('#l_logo').attr("src", "/lims/images/logo_w.png");
				bgstyle = 2;
				e.preventDefault();
			});
			///////////////////press enter
			if ($.browser.mozilla) {
					$("input").bind('keypress', CheckForEnterUpDown);
				} else {
					$("input").bind('keydown', CheckForEnterUpDown);
			}
			function CheckForEnterUpDown(event){
				if (event.keyCode == 13){
					$("#login_btn").trigger("click");	
				}
			}
			
			////////////////////
			
		});

		$("#imgObj").click(function() {
			changeImg();
		});
		function changeImg() {
			var imgSrc = $("#imgObj");
			var src = imgSrc.attr("src");
			imgSrc.attr("src", chgUrl(src));
		}
		function chgUrl(url) {
			var timestamp = (new Date()).valueOf();
			url = url + "?timestamp=" + timestamp;
			return url;
		}
	</script>
</body>
</html>
